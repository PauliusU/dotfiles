# ~/.aliases

# Navigation and file listing
alias cde="cd ~/code/"
alias desk="cd ~/Desktop/"
alias dev="cd ~/dev/"
alias docs="cd ~/Documents/"
alias drb="cd ~/Dropbox/"
alias dt="cd ~/Desktop/" # "dt" is also a command line tool to display information about your domain on Linux or Unix system
alias dwn="cd ~/Downloads/"
# Save and then change the current directory. With no arguments, pushd exchanges the top two directories.
alias pu="pushd"
# Remove the top entry from the directory stack, and cd to the new top directory.
alias po="popd"
# Always list directory contents upon "cd"
function cd() {
	builtin cd "$@" || exit
	ls -A # List entries starting with ., but do not list implied . and ..
}

# Software management
alias bc="brew cleanup" # Remove old versions of installed software
alias bi="brew install"
alias bl="brew list"
alias br="brew reinstall"
alias bs="brew search"
alias bsl="brew services list"
alias bss="brew services stop"
alias bu="brew update && brew upgrade && brew upgrade --cask && brew cleanup"
alias bun="brew uninstall"
alias bunn="brew uninstall --ignore-dependencies"
alias bupc="brew upgrade --cask" # Upgrade all casks installed with homebrew
alias bupd="brew update"         # Update homebrew itself and the package lists
alias bupg="brew upgrade"        # Upgrade all software installed with homebrew
alias sysu="softwareupdate -ai"  # Run all macOS updates for Xcode, etc..
if [[ $(uname) == "Linux" ]]; then
	alias ai="sudo apt install"
	alias ar="sudo apt remove"
	alias aun="sudo apt remove"     # apt (un)install
	alias arr="sudo apt autoremove" # remove packages are no longer needed as dependencies
	alias as="sudo apt search"
	alias acs="apt-cache search"
	alias au="sudo apt update"     # updates repositories
	alias ag="sudo apt upgrade -y" # updates software (packages)
	alias auu="sudo apt update && sudo apt upgrade -y"
fi
function updater() {
	brew update
	brew upgrade && brew upgrade --cask
	brew cleanup
	softwareupdate -ai
}
function apt-updater {
	sudo apt update # Update list of available packages
	sudo apt upgrade -y
	sudo apt autoremove -y
	sudo apt autoclean
	# sudo apt full-upgrade
	# sudo apt-get dist-upgrade
	# sudo do-release-upgrade
}

# Sensible defaults
alias df="df -h"     # human readable
alias du="du -h"     # human readable
alias htop="htop -t" # processes in an indented tree - control+C to stop
alias rm='rm -i'     # prompt before every removal
alias cp='cp -i'     # prompt before overwrite
alias mv='mv -i'     # prompt before overwrite

# Time and Date
alias fulldate="date +%F"
#  Get week number
alias week="date +%V"
# Stopwatch
alias timer="echo 'Timer started. <crtl+d> to break.' && date && time cat && date"

# Network
# IP addresses
alias ip="echo 'External IP:\n\n$(dig +short myip.opendns.com @resolver1.opendns.com)'" # External IP
alias ips="ifconfig | grep inet | grep -v inet6 | awk '{print $2}'"

# Git
alias gcg="git config --global --list" # show global git config
alias gll="git log"                    # "gl" is alias for "git pull" in git plugin
alias gs="git status"
# JS/TS, npm, yarn
alias yb="yarn build"
alias yd="yarn dev"
alias ys="yarn start"
alias yy="yarn install --check-files"
# Python and pip (python is python3)
alias pip=pip3
alias py=python3
alias python=python3
# Pipenv
alias peg="pipenv graph"      # dependency graph
alias peh="pipenv --where"    # project home path
alias pei="pipenv install"    # install dependencies
alias per="pipenv run"        # run a command in the virtual environment without launching a shell
alias perm="pipenv --rm"      # remove virtual environment
alias pes="pipenv shell"      # activate virtual environment
alias peu="pipenv update"     # update all or specified dependencies
alias peun="pipenv uninstall" # uninstall dependency
alias pew="pipenv --venv"     # check location of the environment

# Run scripts and functions
alias fss="~/code/dotfiles-macOs/fs.zsh"
function ytpl() {
	#  Download youtube laylist or channel

	builtin cd ~/Downloads

	# Format for h264 and h265 codec:   -f "bestvideo[vcodec~='^((he|a)vc|h26[45])'][ext=mp4][height>=720][height<=1080][fps>=23]+bestaudio[ext=m4a]" \
	# --restrict-filenames              Restrict filenames to only ASCII characters, and avoid "&" and spaces in filenames
	# --add-metadata                    Alias for --embed-metadata but supports youtube-dl as well
	# --embed-thumbnail                 yt-dlp: Embed thumbnail in the video as cover art || youtube-dl: Embed thumbnail in the audio as cover art
	# -i                                alias for --ignore-errors
	yt-dlp \
		-f "bestvideo[ext=mp4][height>=720][height<=1080][fps>=23]+bestaudio[ext=m4a]" \
		-o "%(upload_date)s %(title)s_%(height)sp_%(fps)sfps.%(ext)s" \
		--playlist-reverse \
		--restrict-filenames \
		--add-metadata \
		--embed-thumbnail \
		-i \
		"$@"
}
function convert_to_hevc() {
	# Convert video to High Efficiency Video Coding (HEVC) / H.265

	if [ -z "$1" ]; then
		echo 'Input file is missing. E.g. "video.webm"'
		# non-zero decimal number in the 1 - 255 range for failure
		return 1
	fi

	# -preset medium    (default)
	# -c:a copy			stream copy audio instead of re-encoding
	ffmpeg -i $1 -c:v libx265 -preset ultrafast -vtag hvc1 -c:a copy "${1%.*}".hevc.mp4
}
function convert_to_avc() {
	# Convert video to Advanced Video Coding (AVC) / H.264

	if [ -z "$1" ]; then
		echo 'Input file is missing. E.g. "video.webm"'
		# non-zero decimal number in the 1 - 255 range for failure
		return 1
	fi

	# -c:a copy			stream copy audio instead of re-encoding
	# -preset medium    (default)
	ffmpeg -i $1 -c:v libx264 -c:a copy "${1%.*}".avc.mp4
}
function convert_to_mp3s() {
	# Convert all files of the same format in the folder to MP3s

	if [ -z "$1" ]; then
		echo 'FILE FILTER ARGUMENT IS MISSING. E.g. "*.opus"'
		# non-zero decimal number in the 1 - 255 range for failure
		return 1
	fi

	for f in "$1"; do ffmpeg -i "$f" "${f%.*}.mp3"; done
}
function merge_mp3s() {
	# Merge all *.mp3 files into single MP3 file

	for file in *.mp3; do
		echo "Processing $file"
		echo "file '$file'" >>list.txt
		ffprobe "$file" 2>&1 | awk '/Duration/ {print $2}'
	done
	ffmpeg -f concat -safe 0 -i list.txt -c copy merged.mp3
	rm list.txt
	mv merged.mp3 "${PWD##*/}".mp3
}

# Shell control
alias ag="alias | grep"
alias brc="$EDITOR ~/.bashrc"
alias c="clear"
alias cls="clear" # or user keyboard shortcut Command + K { # K }
alias ee="exit"
alias fn='find . -name'              # Find by given NAME
alias fnd='find . -type d -name'     # Find by given NAME
alias fnf='find . -type f -name'     # Find by given NAME
alias reload="source ~/.zshrc"       # ZSH settings reload
alias rr="clear && exec ${SHELL} -l" # Reload the shell
alias s="sudo"
alias split_path='echo "$PATH" | sed "s/:/\n/g"' # Display PATH over multiple lines.
alias zrc="$EDITOR ~/.zshrc"
alias zshrc="${EDITOR} ${HOME}/.zshrc"

# System control (startup, restart, shutdown, cron jobs)
alias crn="crontab -e"                                    # edit current crontab
alias restart="sudo shutdown -r now"                      # requires root password, disable it by sudo chmod u+s /sbin/shutdown
alias services="systemctl list-unit-files | grep enabled" # List enabled services (Linux, WSL)
alias shutdown="sudo shutdown -h now"                     # requires root password, disable it by sudo chmod u+s /sbin/shutdown
alias startup="gnome-session-properties"

# Program access
alias bw="bwm-ng -d"     # network speed with dynamic units like K, M or G
alias deb="sudo dpkg -i" # install deb package (for Ubuntu, Debian, Raspbian)
alias nv="nvim"
alias nvrc="${EDITOR} ${HOME}/.config/nvim/init.vim"
alias rmm="rm -rf"                        # Remove non-empty folder
alias space="du -h | awk 'END{print $1}'" # Space used by current folder (and subfolders)
alias td="tmux detach"                    # Exit the tmux window to come back to later
alias tl="tmux ls"                        # = tmux list-sessions
alias tm="tmux"                           # = tmux new = tmux new-session
alias tt="tmux new -As main"              # Attach to (or create if needed) "main" session
alias vi="$BREW_HOME/bin/vi"
alias vim="nvim"
alias vimrc="${EDITOR} ${HOME}/.vimrc"
alias tarx="tar -xvf" # unzip
alias tarz='tar czvf' # zip
alias taru='tar xzvf' # unzip

# Files and directories
alias npc="nvim ~/Dropbox/DropsyncFiles/audiob/notes_PC.md"
