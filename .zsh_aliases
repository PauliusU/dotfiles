# ~/.zsh_aliases

# Navgation
alias cde="cd ~/code/"
alias desk="cd ~/Desktop/"
alias dev="cd ~/dev/"
alias docs="cd ~/Documents/"
alias drb="cd ~/Dropbox/"
alias dt="cd ~/Desktop/"
alias dwn="cd ~/Downloads/"
# Always list directory contents upon "cd"
function cd() {
	builtin cd "$@" || exit
	ls
}

# Brew and software management
alias bc="brew cleanup" # Remove old versions of installed software
alias bi="brew install"
alias bs="brew search"
alias bu="brew update && brew upgrade && brew upgrade --cask && brew cleanup"
alias bun="brew uninstall"
alias bupc="brew upgrade --cask" # Upgrade all casks installed with homebrew
alias bupd="brew update"         # Update homebrew itself and the package lists
alias bupg="brew upgrade"        # Upgrade all software installed with homebrew
alias sysu="softwareupdate -ai"  # Run all macOS updates for Xcode, etc..
function updater() {
	brew update
	brew upgrade && brew upgrade --cask
	brew cleanup
	softwareupdate -ai
}

# Time and Date
alias fulldate="date +%F"
#  Get week number
alias week="date +%V"
# Stopwatch
alias timer="echo 'Timer started. <crtl+d> to break.' && date && time cat && date"

# Network
# IP addresses
alias ip="dig +short myip.opendns.com @resolver1.opendns.com" # External IP
alias ips="ifconfig | grep inet | grep -v inet6 | awk '{print $2}'"

# Sensible defaults
alias df="df -h"     # human readable
alias du="du -h"     # human readable
alias htop="htop -t" # processes in an indented tree - control+C to stop.

# Git
alias gcg="git config --global --list" # show global git config
alias gll="git log"                    # "gl" is alias for "git pull" in git plugin
# JS/TS, npm, yarn
alias yy="yarn install --check-files"
# Python and pip (python is python3)
alias pip=pip3
alias py=python3
alias python=python3
# Pipenv
alias peg="pipenv graph"      # dependency graph
alias peh="pipenv --where"    # project home path
alias pei="pipenv install"    # install dependencies
alias per="pipenv run"        # run a command in the virtual environment without launching a shell
alias perm="pipenv --rm"      # remove virtual environment
alias pes="pipenv shell"      # activate virtual environment
alias peu="pipenv update"     # update all or specified dependencies
alias peun="pipenv uninstall" # uninstall dependency
alias pew="pipenv --venv"     # check location of the environment

# Run scripts and functions
alias fss="~/code/dotfiles-macOs/fs.zsh"
function ytpl() {
	#  Download youtube laylist or channel

	builtin cd ~/Downloads

	# Format for h264 and h265 codec:   -f "bestvideo[vcodec~='^((he|a)vc|h26[45])'][ext=mp4][height>=720][height<=1080][fps>=23]+bestaudio[ext=m4a]" \
	# --restrict-filenames              Restrict filenames to only ASCII characters, and avoid "&" and spaces in filenames
	# --add-metadata                    Alias for --embed-metadata but supports youtube-dl as well
	# --embed-thumbnail                 yt-dlp: Embed thumbnail in the video as cover art || youtube-dl: Embed thumbnail in the audio as cover art
	# -i                                alias for --ignore-errors
	yt-dlp \
		-f "bestvideo[ext=mp4][height>=720][height<=1080][fps>=23]+bestaudio[ext=m4a]" \
		-o "%(upload_date)s %(title)s_%(height)sp_%(fps)sfps.%(ext)s" \
		--playlist-reverse \
		--restrict-filenames \
		--add-metadata \
		--embed-thumbnail \
		-i \
		"$@"
}
function convert_to_hevc() {
	# Convert video to High Efficiency Video Coding (HEVC) / H.265

	if [ -z "$1" ]; then
		echo 'Input file is missing. E.g. "video.webm"'
		# non-zero decimal number in the 1 - 255 range for failure
		return 1
	fi

	# -preset medium    (default)
	# -c:a copy			stream copy audio instead of re-encoding
	ffmpeg -i $1 -c:v libx265 -preset ultrafast -vtag hvc1 -c:a copy "${1%.*}".hevc.mp4
}
function convert_to_avc() {
	# Convert video to Advanced Video Coding (AVC) / H.264

	if [ -z "$1" ]; then
		echo 'Input file is missing. E.g. "video.webm"'
		# non-zero decimal number in the 1 - 255 range for failure
		return 1
	fi

	# -c:a copy			stream copy audio instead of re-encoding
	# -preset medium    (default)
	ffmpeg -i $1 -c:v libx264 -c:a copy "${1%.*}".avc.mp4
}
function convert_to_mp3s() {
	# Convert all files of the same format in the folder to MP3s

	if [ -z "$1" ]; then
		echo 'FILE FILTER ARGUMENT IS MISSING. E.g. "*.opus"'
		# non-zero decimal number in the 1 - 255 range for failure
		return 1
	fi

	for f in "$1"; do ffmpeg -i "$f" "${f%.*}.mp3"; done
}
function merge_mp3s() {
	# Merge all *.mp3 files into single MP3 file

	for file in *.mp3; do
		echo "Processing $file"
		echo "file '$file'" >>list.txt
		ffprobe "$file" 2>&1 | awk '/Duration/ {print $2}'
	done
	ffmpeg -f concat -safe 0 -i list.txt -c copy merged.mp3
	rm list.txt
	mv merged.mp3 "${PWD##*/}".mp3
}

# Other
alias bw="bwm-ng -d" # network speed with dynamic units like K, M or G
alias cls=clear      # or user keyboard shortcut Command + K { # K }
alias ee=exit
alias reload="clear && exec ${SHELL} -l"  # Reload Config
alias rmmm="rm -rf"                       # ZSH settings reload
alias rr="source ~/.zshrc"                # ZSH settings reload
alias space="du -h | awk 'END{print $1}'" # space used by current folder (and subfolders)
alias tl="tmux ls"                        # same as tmux list-sessions
alias tm="tmux"                           # = tmux new = tmux new-session
alias tt="tmux a"                         # = tmux at = tmux attach = tmux attach-session
alias zrc="$EDITOR ~/.zshrc"
